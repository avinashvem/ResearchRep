\documentclass[journal]{IEEEtran}
\input{../Preamble.tex}
\input{../Avinash.def}

\begin{document}
\title{Spatially-Coupled Low-Density Parity-Check Lattices with Applications}
\author{Avinash Vem, Yu-Chih Huang, Krishna R. Narayanan, Henry D. Pfister\\
Department of Electrical and Computer Engineering \\
Texas A\&M University\\
{\tt\small {\{vemavinash@gmail.com, jerry.yc.huang@gmail.com, krn@ece.tamu.edu, hpfister@tamu.edu\}} }}

\maketitle

\begin{abstract}
We propose a new class of lattices constructed using Construction D where the underlying linear codes are nested binary spatially-coupled low-density parity-check codes (SC-LDPC) codes with uniform left and right degrees. By leveraging recent results on the optimality of spatially-coupled codes for binary input memoryless channels and Forney {\em et al.}'s earlier results on the optimality of construction D, we show that the proposed lattices achieve the Poltyrev lixmit under multistage belief propagation decoding. Lattice codes constructed from these lattices are shown to provide excellent performance for the three user symmetric interference channel and bi-directional relay channel. They can also be naturally used in applications such as integer-forcing and compute-and-forward.
\end{abstract}


\section{Introduction}
Lattice codes obtained from nested lattices have been shown to be optimal coding solutions to several problems in information theory \cite{erez05}. In most of these cases, the underlying lattices are constructed using Construction A and it has been shown that such lattices are simultaneously good for shaping (Roger's good) and for channel coding (Poltyrev good) \cite{erez05}. There are two important drawbacks in using optimal lattices constructed using Construction A. On the theoretical side, the use of non-binary codes makes it difficult to prove the optimality of these lattices and lattice codes under practical decoding algorithms such as belief propagation (BP) decoding and so far, we are not aware of any results showing the optimality of Construction A lattices under BP decoding. On the practical side, optimal lattices constructed from Construction A typically require the underlying linear codes to work over large fields and hence, result in formidable decoding complexity, even with BP decoding.

In this paper, we propose a class of lattices constructed using Construction D \cite{BarnesSloane83} where the underlying linear codes are nested binary spatially-coupled low density parity check codes (SC-LDPC) codes with uniform left and right degrees. By using the result that regular SC-LDPC codes can universally achieve capacity under BP decoding for the class of binary memoryless symmetric (BMS) channels  \cite{kudekaruniversal,kumar2013pfister} and by leveraging Forney {\em et al}'s result \cite{forney2000}, we show that the proposed lattices allow us to achieve the Poltyrev
limit under multistage BP decoding. We refer to the proposed lattices as SC-LDPC lattices. Density evolution thresholds show that the proposed SC-LDPC lattices can approach the Poltyrev limit to within 0.2 dB under multistage BP decoding. Very recently, binary polar codes have been used in conjunction with Construction D to obtain Poltyrev-good lattices in \cite{YanLingWu13}. The focus of this paper is on the use of SC-LDPC codes.

We then construct lattice codes from this class of lattices and apply them to the symmetric interference channel \cite{jafar10}.  Recently, it has been pointed out in \cite{Estela13} that there is a natural connection between lattices generated by Construction D (or Construction D$^\prime$) and the interference alignment scheme in \cite{jafar10}. Thus, one can directly implement interference alignment by replacing the
Barnes-Wall lattices in \cite{Estela13} by our proposed SC-LDPC lattices. Simulation results show that this replacement
leads us to a significant gain in terms of bit error probability. This class of lattice codes can also be applied to Integer-forcing or compute-and-forward in the multiple access stage \cite{nazer2011CF}.

Throughout the rest of the paper, vectors and matrices are written in lowercase boldface and uppercase boldface, respectively.

\section{Background}
\label{Section:Background}
\subsection{Lattices and Poltyrev Limit}
Consider a lattice $\Lmb$ with a fundamental volume $V(\Lmb)$. Let us assume that some $\mathbf{\lambda}\in\Lmb$ is transmitted through an additive white Gaussian noise (AWGN) channel of variance $\sigma^{2}$ and denote the noise
vector by $\mathbf{z}$. Let us denote the probability of decoding error, conditional on codeword $\mathbf{\lambda}\in\Lambda$ being
transmitted, as $P(\mathbf{\lambda},\sigma^{2})$ which is defined as
\begin{align*}
 P(\mathbf{\lambda},\sigma^{2}):=\Pr(d(\mathbf{\lambda},\mathbf{\lambda}+\mathbf{z})\geq d(\mathbf{\lambda'},\mathbf{\lambda'}+\mathbf{z}) \text{ for some } \mathbf{\lambda'}\in\Lmb),
\end{align*}
where $d(\mathbf{x},\mathbf{y})$ is the Euclidean distance between $\mathbf{x}$ and $\mathbf{y}$. For an infinite lattice $\Lmb$, $P(\lambda,\sigma^{2})$ is independent of $\lambda$ and hence the average probability of decoding error for the lattice  $P(\Lmb,\sigma^{2})$ is the same as $P(\lambda,\sigma^{2})$ for any $\lambda$.
%Let $Cb(a)$ denote the cube of side $a$ centered at
%origin. We shall  define, $ P(\Lmb,\sigma^{2})$, average probability of decoding error for $\Lambda$, as
%\begin{align*}
% p(\Lmb,\sigma^{2})=\lim_{a\rightarrow \infty}|\Lmb\cap Cb(a)|^{-1}\sum_{\lambda\in \Lmb\cap Cb(a)}p(\lambda,\sigma^{2}).
%\end{align*}
The volume-to-noise ratio (VNR), $\alpha^{2}(\Lmb,\sigma^{2})$,
of an $n$-dimensional lattice $\Lmb$ is given by $\alpha^{2}(\Lmb,\sigma^{2})=\frac{V(\Lmb)^{2/n}}{2\pi e\sigma^{2}}$.
Poltyrev in \cite{poltyrev94} showed that for any VNR $>1$ there exists sequence of lattices for which $P(\Lmb,\sigma^{2}) \rightarrow 0$ as $n \rightarrow \infty$. We shall call such a sequence of lattices as being Poltyrev-good.

\subsection{Construction D and its Goodness}
In this section we briefly describe Construction D lattices \cite{BarnesSloane83}, \cite{conway1999sphere} and then recall Forney {\em et al}'s result on the existence of Poltyrev-good lattices based on this construction \cite{forney2000}.

		Multilevel construction of lattices is based on a sequence of nested codes $\{\mathcal{C}_{l},1\leq l\leq r\}$ where each code $\mathcal{C}_{l}$ is of length $n$ over $\mathbb{F}_q$, a field of size $q$. Construction D and Construction D$^{\prime}$ are based on such nested sequence of linear codes. For detailed description we refer to \cite{conway1999sphere}. Throughout this work we use bianry linear codes i.e., $q=2$. Let $\mathcal{C}_{i}$ be a $(n,k_i)$ binary code spanned by the set of linearly independent binary $n$-tuples $\{\mathbf{g}_1,\mathbf{g}_2,\ldots,\mathbf{g}_{k_i}\}$ where $k_{1}\leq k_{2}\leq \cdots \leq k_{r}$. Using nested binary linear codes $\{\mathcal{C}_{j},1\leq j\leq r\}$, a multilevel Construction D lattice $\Lmb$ is defined as follows:

\begin{align}\label{Eqn:ConstrD}
 \Lmb=\bigcup \left\{2^{r}\Z^{n}+\sum_{1\leq j\leq r}\sum_{1\leq i\leq k_{j}}\alpha_{ji}2^{j-1}\mathbf{g}_i|\alpha_{ji}\in\{0,1\}\right\}
\end{align}
where ``$+$" denotes addition in $\R^{n}$. The VNR of a Construction D lattice described above is given by

\begin{equation}
    \alpha^{2}(\Lmb,\sigma^{2})=\frac{2^{2(r-\sum_{i=1}^{r}k_{i}/n)}}{2\pi e\sigma^{2}}.
\end{equation}

Before we describe the multistage decoding used, let $\lambda\in\Lmb$, where $\Lmb$ is as defined in \eqref{Eqn:ConstrD}, be transmitted through an AWGN channel and $\mathbf{y}=\lambda+\mathbf{z}$ is received where $\mathbf{z}\sim\mathcal{N}(0,\sigma^{2})$. Let $\hat{\mathbf{y}}_{0}=\mathbf{y}$.

\begin{itemize}
\item \textbf{Step 1}: At stage $j, $ $1\leq j\leq r$, $\hat{\mathbf{y}}_{j-1}\mod 2$ is decoded to a codeword  $\hat{\mathbf{x}}_{j}\in \mathcal{C}_{j}$. Also, the corresponding information bits  $\{\hat{\alpha}_{j1},\hat{\alpha}_{j2}\cdots \hat{\alpha}_{jk_{j}}\}\in \{0,1\}^{k_{j}}$ that generate $\hat{\mathbf{x}}_{j}$, are computed.
\item \textbf{Step 2}: Compute $\hat{\mathbf{y}}_{j}= \frac{1}{2} \cdot(\hat{\mathbf{y}}_{j-1}-\sum_{1\leq i\leq k_{j}}\hat{\alpha}_{ji}\mathbf{g}_i)$. Repeat \textbf{Step 2}.
\item \textbf{Step 3}: At $(r+1)^{\text{th}}$ stage of decoding, $\hat{\mathbf{y}}_{r}$ is decoded to the closest $\mathbf{q}\in\Z^{n}$.
\item \textbf{Output}: Decoded lattice point $\hat{\mathbf{\lambda}}\in\Lmb$ is given by
\begin{align}
    \hat{\mathbf{\lambda}}=2^{r}\mathbf{q}+\sum_{1\leq j\leq r}\sum_{1\leq i\leq k_{j}}\hat{\alpha}_{ji}2^{j-1}\mathbf{g}_i.
\end{align}

\end{itemize}

At the $j^{\text{th}}$ stage of decoding, conditioned on successful decoding in previous stages, the input to the decoder is of the
form

\begin{align}
\hat{\mathbf{y}}_{j-1} \hspace{-8pt}\mod 2%&=\frac{1}{2}\left(\hat{\mathbf{y}}_{j-2}-\sum_{1\leq i\leq k_{j-1}}\alpha_{(j-1)i}\mathbf{g}_i\right)\hspace{-8pt}\mod 2\notag\\
%&=\left( \frac{1}{2^{j-1}}\hat{\mathbf{y}}_{0}-\sum_{1\leq p< j}2^{p-j}\sum_{1\leq i\leq k_{p}}\alpha_{pi}\mathbf{g}_i \right) \hspace{-8pt}\mod 2\notag\\
&=\frac{1}{2^{j-1}}\left( \mathbf{y}-\sum_{1\leq p< j}\sum_{1\leq i\leq k_{p}}2^{p-1}\alpha_{pi}\mathbf{g}_i \right) \hspace{-8pt}\mod 2\notag\\
&=\left(\sum_{i=1}^{k_{j}}\alpha_{ji}\mathbf{g}_i \right) \hspace{-8pt}\mod 2 + \left( 2^{-(j-1)}\mathbf{z} \right) \hspace{-8pt}\mod 2\notag\\
&=\mathbf{x}_{j}+2^{-(j-1)}\mathbf{z} \hspace{-8pt}\mod 2,
\label{Eqn:Mod2Channel}
\end{align}
where $\mathbf{x}_{j}\in\mathcal{C}_{j}$. We call the channel defined in \eqref{Eqn:Mod2Channel} as an additive mod-2 Gaussian noise (AMGN) channel \cite{forney2000} and denote the capacity for this channel as  $\text{C}_{\text{AMGN}}(\sigma_{\text{eff}})$ where $\sigma_{\text{eff}}^{2}=2^{-2(j-1)}\sigma^{2}$.
% which is shown to be equal to $C(2^{j-1}\Z/2^{j}\Z,\sigma^{2})$\cite{forney2000}.

\begin{theorem}[Forney \textit{et al.} \cite{forney2000}]
For an AWGN channel with noise variance per dimension $\sigma^{2}$, there exists a sequence of construction D lattices $\Lmb$ based on a chain of two-way one-dimensional lattice partitions and $r$ nested random binary linear codes $\mathcal{C}_{1}\subseteq \mathcal{C}_{2}\cdots \subseteq \mathcal{C}_{r}$ that is Poltyrev-good.
\end{theorem}

\begin{Remark}\label{Rmk:Forney_proof}
    Note that in \cite{forney2000}, it was shown that if for each level $j\in\{1,\ldots,r\}$ the linear code $\mathcal{C}_{j}$ at that respective level is arbitrarily close to the capacity of the respective AMGN channel in the multistage decoding and has an arbitrarily low error probability then the Construction D lattice thus constructed is arbitrarily close to Poltyrev-limit with an arbitrarily low probability of error.
\end{Remark}

\section{Proposed SC-LDPC Lattices}\label{Sec:SCLDPC}
As we can see from $\eqref{Eqn:ConstrD}$, construction of lattices based on Construction D using SC-LDPC codes requires the spanning sets or equivalently, generator matrices, of the respective codes to be nested. In other words we need a sequence SC-LDPC codes where each code is nested in the next code in the sequence. In this section, we first construct such a sequence of nested linear codes where each code has the structure similar to a SC-LDPC system and hence has good error performance at rates arbitrarily close to Shannon capacity. For ease of exposition, we restrict our description to the case $r=2$. For other cases the construction extends naturally.

\subsection{Construction}
Let the rates $r_{1}$ and $r_{2}$, $0< r_{1}<r_{2}$, be given. Our objective is to construct Tanner graphs $\mc{G}_{1},\mc{G}_{2}$ similar in structure to a SC-LDPC system such that the binary codes $\mc{C}_{1},\mc{C}_{2}$ defined by the respective graphs are nested i.e., $\mc{C}_{1}\subseteq \mc{C}_{2}$ and the rates are arbitrarily close to $r_{1}$ and $r_{2}$ respectively.
%nested SC-LDPC code ensemble parameterized by $(L,w)$ where $L$ is the number of independent LDPC systems coupled and $w$ is the coupling width whose design rates tend to $r_{1}$ and $r_{2}$, respectively, in the limit of $w,L\rightarrow \infty$.
For small enough $\epsilon >0$, choose $d_{c}\in\N$ such that there exists $d_{v}^{1},d_{v}^{2}\in \N$,
\begin{align}
	d_{v}^{i}\geq 3 \hspace{0.3cm} \text{  and }  \hspace{0.3cm}  1-\frac{d_{v}^{i}}{d_{c}}>r_{i}-\epsilon, i\in \{1,2\}.
						\label{Eqn:DegreeConditions1}
\end{align}
The $\epsilon$ leeway in the above equations is just for rounding off $r_{i}$ to the nearest rational number and not very important.

In this approach we first construct a regular $(d_{v}^{1},d_{c})$ Tanner graph $\mc{G}_{1}$ where regularity here means that all the variables have degree $d_{v}^{1}$ and all checks have degree $d_{c}$. Then we obtain the Tanner graph $\mc{G}_{2}$ by removing a fraction of the parity checks and the edges incident on these checks in a way that $\mc{G}_{2}$ is $(d_{v}^{2},d_{c})$ regular. The ensemble described in\cite{KudekarUrbanke11} is not directly amenable to our approach of deriving the higher rate code, since removing a fraction of the checks from this ensemble does not result in a regular SC-LDPC code. Therefore, our approach is to use the following multi edge-type construction.

Fix $M\in \N$. We place $M d_{c}$ variable nodes at positions $[1: L]\coleq\{1,2,\ldots ,L\}$, $L\in\N$ and $Md_{v}^{1}$ check nodes at positions $[1 : L+w-1]$, where $w\in \N$ is the coupling width. At each position divide the $Md_{v}^{1}$ check nodes into $d_{v}^{1}$ groups where each group contains $M$ check nodes. At any position we refer to all check nodes belonging to $k^{th}$ group as of type $\mc{T}_{k}$. Similarly, for each variable node, we classify the $d_{v}^{1}$ edges into types, where $k^{\text{th}}$ type is referred to as type $\mc{E}_{k}$ which equates to $Md_{c}$ edges of each type at any position. For a fixed $k \in [1 : d_{v}^{1}]$, for all $i \in [1 : L]$, each edge of type $\mc{E}_{k}$ at position $i$ is assigned independently and unfiormly at random to a type $\mc{T}_{k}$ check node from positions $[i : i+w-1]$. The main idea is that, for each $k\in [1:d_{v}^{1}]$, if we consider the sub-graph containing only the type $\mc{T}_{k}$ check nodes and variable nodes with single edge( type $\mc{E}_{k}$ edges) the above mimics the construction of a $(1,d_{c},L,w)$ ensemble \cite{KudekarUrbanke11} on the sub-graph. This results in a Tanner graph in which every variable node has exactly one edge connected to type $\mc{T}_{k}$ check node, for all $k \in [1: d_{v}^{1}]$. We call such graph, a \textit{check-uniform connected graph}.

More precisely, the ensemble is defined as follows. Choose $M$ such that $\frac{Md_{c}}{w}$ is a natural number. Fix $k\in[1:d_{v}^{1}]$ and $i\in[1:L]$. Choose a permutation $\pi^{v}_{i,k}$ uniformly at random from the set of $Md_{c}$ letters. Under arbitrary indexing of the $Md_{c}$ variable nodes at position $i$, for $j\in [0:w-1]$, assign $\mc{E}_{k}$ type edges of $\pi^{v}_{i,k}\left((j-1)\frac{Md_{c}}{w}+1:j\frac{Md_{c}}{w}\right)$ variable nodes at position $i$ to check nodes at position $i+j$. Under this assignment, ignoring the boundary effects, for each check type at position $i$, the number of edges that come from variables at position $i-j$ is $\frac{Md_{c}}{w}$, a $w^{\text{th}}$ fraction of the total number of connections. From the check nodes perspective, for $k\in[1:d_{v}^{1}]$, at  each position, distribute these edges according to a permutation $\pi^{c}_{i,k}$ chosen uniformly at random from the set of all permutations on $Md_{c}$ letters. We call the proposed construction as $(d_{v}^{1},d_{c},L,w)$ \textit{check-uniform} SC-LDPC (CU-SC-LDPC) ensemble of codes.  

Choose a tanner graph uniformly at random from the above described $(d_{v}^{1},d_{c})$ CU-SC-LDPC ensemble, call it $\mc{G}_{1}$. Observe that, removal of all check nodes of a particular type, say $\mc{T}_{d_{v}^{1}}$, from $\mc{G}_{1}$ results in regular $(d_{v}^{1}-1,d_{c})$ Tanner graph. One can see that removal of all check nodes of types $\mc{T}_{d_{v}^{2}+1},\mc{T}_{d_{v}^{2}+2},\ldots, \mc{T}_{d_{v}^1} $ from $\mc{G}_{1}$ results in a graph from the $(d_{c},d_{v}^{2},L,w)$ CU-SC-LDPC ensemble, which let us refer to as $\mc{G}_{2}$. More importantly, all the check-nodes in the derived graph $\mc{G}_{2}$ are also contained in $\mc{G}_{1}$ and hence any codeword satisfying the check constraints in $\mc{G}_{1}$ also satisfy the check constriants in $\mc{G}_{2}$. Thus we can say that the binary code $\mc{C}_{1}$ defined by $\mc{G}_{1}$ is a sub-code of the binary code $\mc{C}_{2}$ defined by $\mc{G}_{2}$. One can obtain a sequence of nested linear codes $\mc{C}_1\subseteq\mc{C}_2\subseteq\ldots\mc{C}_r$ by	 repeatedly performing the above operation. Given $(d_{c},d_{v}^{1},\ldots,d_{v}^{r})$, for each code $\mc{C}_{1}$ from the $(d_{c},d_{v}^{1},L,w)$ CU-SC-LDPC ensemble, we can obtain a nested sequence of codes $\mc{C}_1\subseteq\mc{C}_2\subseteq\ldots\subseteq\mc{C}_r$.  We call the proposed ensemble of nested sequences of codes as $(d_{c},d_{v}^{1},\ldots,d_{v}^{r},L,w)$ CU-SC-LDPC ensemble. 

\begin{Remark}\label{Rmk:EquivNestedConstr1}
Observe that choosing $\mc{G}_{1}$ unifromly at random from the $(d_{c},d_{v}^{1},L,w)$ CU-SC-LDPC ensemble is equivalent to choosing uniformly a set of permutations $\Pi_{1}=\{\pi_{i,k}^{c},\pi_{i,k}^{v}: i\in[1:L],k\in[1:d_{v}^{1}]\}$. Deriving nested graph $\mc{G}_{2}$ is equivalent to considering just the subset: $\Pi_{2}=\{\pi_{i,k}^{c},\pi_{i,k}^{v}: i\in[1:L],k\in[1:d_{v}^{2}]\}$ of permutations. Hence this construction of nested codes is equivalent to first constructing $\mc{G}_{2}$ by choosing $\Pi_{2}$ and then deriving $\mc{G}_{1}$ by choosing $\{\pi_{i,k}^{c},\pi_{i,k}^{v}: i\in[1:L], k\in[d_{v}^{2}+1:d_{v}^{1}]\}$ to construct $\Pi_{1}$ or equivalently $\mc{G}_{1}$.
\end{Remark}

\begin{figure}[t]
\centering
\resizebox {\columnwidth} {!} {
\input{./figures/Basegraph.tex}
}
\caption{A example Tanner graph from the $(3,6)$, $L=3$, $w=2$ CU-SC-LDPC ensemble. Removal of all the type $\mc{T}_{1}$ check nodes i.e the filled nodes, results in a $(2,6)$ CU-SC-LDPC protograph, see Fig.\ref{BaseGraph_sup}. }
\label{Basegraph}
\end{figure}


\begin{figure}[b]
\centering
\resizebox {\columnwidth} {!} {
\input{./figures/Basegraph_sup.tex}
}
\caption{A $(2,6)$ SC-LDPC sub-graph of the ($3,6$) SC-LDPC graph shown in Fig.\ref{Basegraph}.}
\label{BaseGraph_sup}
\end{figure}

\begin{Example}\label{Ex:ConstrD.1}
For $r_{1}=0.5$, $r_{2}=0.9$ let us try to compute the degree profiles satisfying \eqref{Eqn:DegreeConditions1}. One can see that      any triplet $(d_{c},d_{v}^{1},d_{v}^{2})=(10k, 5k, k), k\geq 3$, satisfies all the required conditions and $(30, 15, 3)$ is the simplest degree profile. We will see later the justification for choosing, $r_{2}=0.9$ in this example (or in general why a nested super-code of high rate, close to 1, is required).
\end{Example}
As we have seen in Example \ref{Ex:ConstrD.1}, the CU-SC-LDPC construction requires to work with high degree tanner graphs. Therefore when one attempts multi-stage decoding on lattices based on the proposed nested CU-SC-LDPC ensemble, BP decoding needs to be carried out on a highly complex, a regular $(15,30)$ Tanner graph in Example \ref{Ex:ConstrD.1}. For this purpose, to avoid high degree tanner graphs, we propose the following alternate construction.

\subsection{Alternate Construction}
Contrast to the previous construction where the check node degree remains same over all the graphs in the sequence of nested codes, in this cosntruction the variable node degree remains same over the all the graphs in the sequence of nested codes.

Let the the rates $r_{1}, r_{2}$ with $0<r_{1}<r_{2}$ be given. For small enough $\epsilon >0$, choose $d_{v}\geq 3$ such that there exists $d_{c}^{1},d_{c}^{2}\in \N$,
\begin{align}
		d_{c}^{2}=q d_{c}^{1}, q\in \N \hspace{0.3cm} \text{  and } \hspace{0.3cm}   1-\frac{d_{v}}{d_{c}^{i}}>r_{i}-\epsilon, i\in \{1,2\}.
\label{Eqn:DegreeConditions2}
\end{align}

%the remove check nodes to derive a nested code of higher rate (super-code), we add check nodes to arrive at a nested code of lower rate (sub-code).

In this construction of nested pair, $\mc{C}_{1}\subseteq \mc{C}_{2}$, of SC-LDPC codes, we first describe the construction of $\mc{C}_{2}$ and then the procedure of deriving the sub-code $\mc{C}_{1}$. The construction of $\mc{C}_{2}$ is identical to that of the $(d_{v},d_{c}^{2},L,w)$ SC-LDPC ensemble described in \cite{KudekarUrbanke11}. For sake of self-sufficiency we briefly describe the construction here. For details we refer the reader to  \cite{KudekarUrbanke11}.

Fix $M$ such that $\frac{Md_{v}}{d_{c}^{2}}\in \N$. We place $M$ variable nodes at positions $[1: L]$, $L\in\N$ and $\frac{Md_{v}}{d_{c}^{2}}$ check nodes at positions $[1 : L+w-1]$, where $w\in \N$ is the coupling width. From the variable node perspective we make the assignments such that each of the $d_{v}$ connections of a variable n	ode at position $i$ is chosen independetly and uniformly from the range $[i : i+w-1]$. Ignoring the boundary effects, the above assignments are such that, for check nodes  at position $i$, the number of edges that come from variable nodes at position $i-j$, $j\in[0:w-1]$ is $\frac{Md{v}}{w}$. In other words it is exactly $w$th fraction of the total number of edges at position $i$. 
%For check nodes at position $i$, 
We distribute these edges to $\frac{Md_{v}}{d_{c}^{2}}$ check nodes at position $i$ according to a permutation $\pi_{i}$ chosen uniformly at random from the set of permutations on $Md_{v}$ letters. With this we can also assume that each of the $d_{c}^{2}$ connections of a check node at position $i$ is independently chosen from the range $[i-w+1 : i]$. Until this point the construction is identical to the $(d_{v},d_{c}^{2},L,w)$ ensemble described in \cite{kudekaruniversal}, which we hereafter refer to as $(d_{v},d_{c}^{2},L,w)$ SC-LDPC ensemble. 

We now will describe the construction of a nested sub-code contained in a code from the above ensemble. Let a graph $\mc{G}_{2}$ be picked uniformly at random from the  $(d_{v},d_{c}^{2},L,w)$ SC-LDPC ensemble and let the binary code defined by this tanner graph be $\mc{C}_{2}$. Consider a check node $C$ in $\mc{G}_{2}$ and
% and let's denote the set of bit nodes connected to the check node $c$ as $V_{c}$. 
replace the check node $C$ by check nodes $C_{1}, C_{2}, \ldots, C_{q}$ where each new check node $C_{i}$ has a degree $d_{c}^{1}$( Recall: $d_{c}^{2}=q d_{c}^{1},q\in \N$, by design). With an arbitrary ordering of the $d_{c}^{2}$ edges incident on $C$, distribute these edges to the new checks $C_{1}, C_{2}, \ldots, C_{q}$ according to a partition $\Pi_{C}$ picked uniformly at random from the set of all ``partitions of a set of $qd_{c}^{2}$ letters into $q$ subsets of equal size''. 
%the identity permutation of $d_{c}$ leters. permutation $P_{c}$ chosen uniformly at random from the set of all permutations on $d_{c}^{2}$ letters. 
Note that this operation, which we refer to as \textit{check-splitting}, does not alter the degree of  any variable node in the graph. By performing the \textit{check-splitting} operation on all the check nodes in $\mc{G}_{2}$, we derive a regular $(d_{v},d_{c}^{1})$ tanner graph. Let the derived graph be denoted $\mc{G}_{1}$ and let the binary code defined by $\mc{G}_{1}$ be $\mc{C}_{1}$.	

\begin{Remark}\label{Rmk:EquivNestedConstr2}
Note that given a code $\mc{C}_{2}$ from the $(d_{v},d_{c}^{2},L,w)$ SC-LDPC ensemble, deriving a sub-code $\mc{C}_{1}$ is equivalent to choosing a set of partitions: $\{\Pi_{C},C \text{ for all check nodes} C \text{ in } \mc{C}_{2}\}$. Therefore we can say that in this construction, for any choice of $\mc{C}_{2}$ there are equal number of choices for $\mc{C}_{1}$ $(d_{v},d_{c}^{1},L,w)$ SC-LDPC ensemble which are all equal likely.
\end{Remark}

\begin{lemma}\label{Lemma:NestedCodes}
$ \mc{C}_{1} \subseteq \mc{C}_{2}$
\end{lemma}
\begin{IEEEproof}
Let $c$ be a check node in $\mc{G}_{2}$ and $\mbf{h}_{c}$ be the  corresponding parity-check vector. As each check node $c$ in $\mc{G}_{2}$ is replaced by check nodes $\{c_{1},\ldots , c_{q}\}$ in $\mc{G}_{1}$ let their corresponding parity check vectors be $\{\mbf{h}_{c_{1}},\ldots , \mbf{h}_{c_{q}}\}$. Clearly, from the construction,
\begin{align*}
\mbf{h}_{c}=\mbf{h}_{c_{1}}+\ldots +\mbf{h}_{c_{q}}.
\end{align*}
Consider $\mbf{x}\in\mc{C}_{1}$ and a check node $c\in \mc{G}_{2}$. As $\mbf{x}$ satisifies all the parity-check equations in $\mc{G}_{1}$, $\mbf{h}^{T}_{c_{i}}\cdot \mbf{x}\equiv 0 \mod 2, 1\leq i \leq q$.
\begin{align*}
\mbf{h}^{T}_{c}\cdot \mbf{x}&=\left[\mbf{h}^{T}_{c_{1}}+\ldots +\mbf{h}^{T}_{c_{q}}\right] \cdot \mbf{x}\\
												&\equiv 0 \mod 2. 
\end{align*}
The above implies $\mbf{h}^{T}_{c}\cdot \mbf{x}\equiv 0 \mod 2, \hspace{0.2cm} \forall c\in \mc{G}_{2}$ and hence $x\in \mc{C}_{2}$.
\end{IEEEproof}
We call the set of all $n$-tuples $(\mc{C}_{1},\mc{C}_{2},\ldots,\mc{C}_{r})$ of codes, where $\mc{C}_{1}\subseteq \ldots\subseteq\mc{C}_{r}$ derived from the above construction as $(d_{v},d_{c}^{1},\ldots,d_{c}^{r})$ VC-SC-LDPC ensemble of nested codes. Here VC means \textit{variable-constant} referring to variable degree remaining same throughout the nested sequence of codes. From here after when a nested chain of codes is referred to as SC-LDPC and no distinction between the constructions CU-SC-LDPC or VC-SC-LDPC is made, we mean that the statement is valid for both the constructions.\\
%One can obtain a sequence of nested linear codes $\mc{C}_1\subseteq\mc{C}_2\subseteq \ldots\mc{C}_r$ by repeatedly performing the above operation, starting from $\mc{C}_{r}$. We observe in this construction, unlike the previous construction, that for any code $\mc{C}_{2}$ from the $(d_{v},d_{c}^{2})$ SC-LDPC ensemble, the choice for deriving a sub-code is not unique. The non-uniqueness arises from the fact that for each check $c$ the number of choices for the permutation $P_{c}$ is not unique and any set of permutations will result in a valid sub-code.

Since Construction D works with generator matrices of nested linear codes, we have to obtain nested generator matrices from the proposed nested SC-LDPC codes. In the following lemma, we show the existence of such nested generator matrices for any set of nested binary linear codes.
\begin{lemma}\label{Lemma:NestedGeneratorMatrix}
    Given nested binary linear codes $\C_{1}\subseteq \mathcal{C}_{2}\subseteq\ldots \subseteq\mathcal{C}_{r}$ there exists nested generator matrices for these codes.
\end{lemma}
\begin{IEEEproof}
It suffices to consider the case having only two levels. For $\mathcal{C}_{1}$ there exists set of linearly independent binary vectors
$\mathbf{G}_{1}=\{\mathbf{g}_1,\mathbf{g}_2,\ldots, \mathbf{g}_{k_1}\}$ that span $\mathcal{C}_{1}$ where $k_{1}=$dim$(\mathcal{C}_{1})$.
Denote $\mathbf{Z}_{i}=\{\mathbf{G}_{1},\mathbf{g}_{k_{1}+1},\mathbf{g}_{k_{1}+2}, \ldots, \mathbf{g}_{k_{1}+i-1}\}$ and $Y_{i}=\mathcal{C}_{2}\setminus$
span$(\mathbf{Z}_{i})$ for $i=1,2, \ldots, k_{2}-k_{1}$. Note that for any $\mathbf{x}\in Y_{i}$, $\mathbf{x}$ is linearly independent with $\mathbf{Z}_{i}$ and hence
$\mathbf{Z}_{i+1}=\{\mathbf{Z}_{i},\mathbf{g}_{k_{1}+i}\}$ forms a linearly independent set where $\mathbf{g}_{k_{1}+i}=\mathbf{x}$. This recursive procedure gives us a basis $\mathbf{G}_{2}$ for $\mathcal{C}_{2}$. Thus the existence of the generator matrices for nested binary linear codes is shown.
\end{IEEEproof}
From the above Lemma~\ref{Lemma:NestedGeneratorMatrix}, given nested SC-LDPC codes $\mathcal{C}_{1}\subseteq \mathcal{C}_{2}\ldots \subseteq\mathcal{C}_{r}$, one can find a corresponding sequence of nested sets of generator vectors $\mathbf{G}_{1}\subseteq \mathbf{G}_{2} \subseteq \ldots \subseteq\mathbf{G}_{r}$ and hence can use Construction D described in \eqref{Eqn:ConstrD} with the proposed SC-LDPC codes. We refer to the lattice thus constructed as the \textit{SC-LDPC lattice}.

\begin{Discussion}
For any code from the $(d_{v},d_{c},L,w)$ SC-LDPC ensemble, the design rate can be computed to be 
\begin{align}
R(d_{v},d_{c},L,w)=1-\frac{d_{v}}{d_{c}}\frac{L+w-1}{L}.
\label{Eqn:DesignRate}
\end{align}
Similarly we define the design VNR of the proposed SC-LDPC lattices to be 
\begin{align*}
\alpha^{2}_{*}(\Lmb,\sigma^{2})=\frac{2^{2(r-\sum_{i=1}^{r}R_{i})}}{2\pi e\sigma^{2}}.
\end{align*}
where $R_{i}$ is the design rate of the $i^{\text{th}}$ code in the nested sequence of SC-LDPC codes used in SC-LDPC Lattice. Although the design rate \eqref{Eqn:DesignRate} and the actual rate for any code from the ensemble are not necessarily equal, it is important to observe that the actual rate is atleast as large as the design rate, which gives the follwoing inequality on the actual VNR of the SC-LDPC lattice,
\begin{align}
\alpha^{2}(\Lmb,\sigma^{2})\leq \alpha^{2}_{*}(\Lmb,\sigma^{2}).
\label{Eqn:VNRInequality}
\end{align}
%they are assumed to be equal (\textbf{Probably a reference for justification?}). 
\end{Discussion}


\subsection{Poltyrev-Goodness of the Proposed Lattices}
We now show the existence of a sequence of lattices which is Poltyrev-good under BP decoding. In the following lemmas, we show that the proposed SC-LDPC codes( both the constructions) achieve the AMGN channel capacity. We then follow the argument by Forney \textit{et al.} described in Remark~\ref{Rmk:Forney_proof} to show the result.

\begin{lemma}\label{Lemma:DE_SCLDPC}
For a BMS channel with associated L-density \cite{richardson2008modern} $\mathbf{x}_{\text{BMS}}$, density evolution (DE) equation for a ($d_{v},d_{c},L,w$) CU-SC-LDPC ensemble is given by
\begin{align}
%x_{i}^{(l)}=\epsilon\left( 1-\frac{1}{w}\sum_{j=0}^{w-1}\left(1-\frac{1}{w}\sum_{k=0}^{w-1}x_{i+j-k}^{(l-1)}\right)^{d_{r}-1} \right)^{d_{l}-1},
\mathbf{x}_{i}^{(l)}=\mathbf{x}_{\text{BMS}}\circledast\left( 1-\frac{1}{w}\sum_{j=0}^{w-1}\left(1-\frac{1}{w}\sum_{k=0}^{w-1}\mathbf{x}_{i+j-k}^{(l-1)}\right)^{\boxast d_{c}-1} \right)^{\circledast d_{v}-1},
\label{Eqn:DE_SCLDPC}
\end{align}
where $\mathbf{x}_{i}^{(l)}$ is the average L-density which is emitted by a variable node at position $i$ in iteration $l$.
\end{lemma}
\begin{IEEEproof}
In the proposed CU-SC-LDPC ensemble, from the perspective of a variable node there are $d_{v}$ types of edges $\mc{E}_{1},\mc{E}_{2},\cdots,\mc{E}_{d_{v}}$. We denote edges of type $\mc{E}_{k}$ that originate from a variable node at position $i$ as $(i,\mc{T}_{k})$ and the L-density of the message emitted by variable nodes along such edge types as $\mathbf{x}_{ik}^{(l)}$ where $l$  denotes the iteration. But from the perspective of a check node of any type at position $i$, an edge is randomly connected to one of the variable nodes located at positions $\{i, i-1,... i-w+1\}$.	Hence all the edges connected to check nodes at a certain position are statistically identical and more importantly all check nodes at certain position are statistically identical. The average L-density of the message emitted by a check node at position $i$ in iteration $l$, denoted by $\mathbf{y}_{i}^{(l)}$, is given by
\begin{align}
\mathbf{y}_{i}^{(l)}=\left(\frac{1}{w}\sum_{j=0}^{w-1}\left(\frac{1}{d_{v}}\sum_{k=0}^{d_{v}}\mathbf{x}_{(i-j)k}^{(l-1)}\right)\right)^{\circledast d_{c}-1}
\label{Eqn:CheckNodeUpdate}
\end{align}
And a variable node update is given by
\begin{align}
\mathbf{x}_{ik}^{(l)}&=\mathbf{x}_{\text{BMS}}\boxast \left(\frac{1}{w}\sum_{j=0}^{w-1}\mathbf{y}_{i+j}^{(l)}\right)^{\boxast d_{v}-1}\label{Eqn:VariableNodeUpdate}\\
\mathbf{x}_{i}^{(l)}&=\frac{1}{d_{v}}\sum_{k=0}^{d_{v}}\mathbf{x}_{ik}^{(l)}\notag
\end{align}
where $\mathbf{x}_{i}^{(l)}$ is the average L-density of the log-likelihood ratio of variable nodes at position $i$.
Combining \eqref{Eqn:CheckNodeUpdate} and \eqref{Eqn:VariableNodeUpdate} and observing that the initialization
is $\mathbf{x}_{i}^{(1)}=\mathbf{x}_{i1}^{(1)}=\mathbf{x}_{i2}^{(1)}=\cdots=\mathbf{x}_{id_{v}}^{(1)}=\mathbf{x}_{\text{BMS}}$ completes the proof.
\end{IEEEproof}

Note that in \eqref{Eqn:DE_SCLDPC} we show that the DE equations for the proposed CU-SC-LDPC ensemble are identical to that of SC-LDPC ensemble proposed in \cite{KudekarUrbanke11,kudekaruniversal}.
\begin{Remark}\label{Rmk:Same_DE}
In the second construction, a $(d_{v},d_{c},L,w)$ SC-LDPC ensemble is identical to the one in \cite{kudekaruniversal} and hence the DE equations in \eqref{Eqn:DE_SCLDPC} also hold valid for the $(d_{v},d_{c},L,w)$ SC-LDPC ensemble.
\end{Remark}

\begin{lemma}\label{Lemma:BMSProof1}
For any $\delta$, $\epsilon>0$, there exists parameters $d_{c},d_{v},L,w$ such that the design rate $R(d_{v},d_{c},L,w)>C_{\text{AMGN}}(\sigma^{2})-\delta$ and a code $\mc{C}$ from the  $(d_{v},d_{c},L,w)$ CU-SC-LDPC  ensemble such that $P_{b}^{\text{BP}}(\mc{C},\sigma)< \epsilon$, where $P_{b}^{\text{BP}}(\mc{C},\sigma)$ is the average bit error probability under BP decoding for $\mc{C}$ over AMGN channel with noise variance $\sigma^{2}$ and $C_{\text{AMGN}}(\sigma^{2})$ is the corresponding Shannon capacity.
\end{lemma}
\begin{IEEEproof}
It has been proved in \cite{kudekaruniversal,kumar2012proof} that over any BMS channel, under BP decoding, any system that satisfies the equation \eqref{Eqn:DE_SCLDPC} achieve the capacity as $d_{v},w,L \rightarrow \infty$ (with $\frac{d_{v}}{d_{c}}$ fixed), in that order. Hence if we show that the AMGN channel described in \eqref{Eqn:Mod2Channel} is indeed a BMS channel, then from Lemma \ref{Lemma:DE_SCLDPC} it follows that there exist $d_{c},d_{v},L,w$ large enough such that the design rate $R(d_{v},d_{c},L,w)>C_{\text{AMGN}}-\epsilon$ and the bit error probability $\rightarrow 0$  as $M\rightarrow \infty$. It is clear to see that the AMGN channel has binary input and output lying in an interval of length $2$. Let the input alphabet to the channel be $\{0,1\}$ and without loss of generality let the $\mod 2$ operation produces a output lying in $[-0.5,  1.5]$. Then the conditional PDFs of $\mathbf{y}$ can be written as
\begin{align}
f(y|x=0)&=\frac{1}{\sqrt[]{2\pi e\sigma^{2}}}\sum_{j=-\infty}^{\infty}\exp\left[\frac{ -(y+2j)^{2}}{2\sigma^{2}}\right]\\
f(y|x=1)&=\frac{1}{\sqrt[]{2\pi e\sigma^{2}}}\sum_{j=-\infty}^{\infty}\exp\left[\frac{ -(y+2j-1)^{2}}{2\sigma^{2}}\right].
\end{align}
Therefore the PDFs of the output satisfy
\begin{align*}
f(y-0.5|1)=f(0.5-y|0) \hspace{10pt} \text{ for all } y\in [-0.5, 1.5].
\end{align*}
Thus, it belongs to the class of BMS channels.
\end{IEEEproof}

\begin{lemma}\label{Lemma:BMSProof2}
For any $\delta ,\epsilon>0$, there exists $d_{c},d_{v},L,w$ and code $\mc{C}$ from ($d_{c},d_{v},L,w$) SC-LDPC  ensemble such that the design rate $R(d_{v},d_{c},L,w)>C_{\text{AMGN}}(\sigma^{2})-\delta$ and $P_{b}^{\text{BP}}(\mc{C}_{i},\sigma)< \epsilon$.

%For any $\epsilon>0$, there exists a sequence of codes, parameterized by $M$, from ($d_{c},d_{v},L,w$) SC-LDPC  ensemble such that the design rate $R(d_{v},d_{c},L,w)>C_{\text{AMGN}}-\epsilon$ and the bit error probability under BP decoding $\rightarrow 0$  as $M\rightarrow \infty$, where $C_{\text{AMGN}}$ is the Shannon capacity of the AMGN channel.
\end{lemma}
\begin{IEEEproof}
The proof above that AMGN channel is BMS and Remark \ref{Rmk:Same_DE} gives us the required result.
\end{IEEEproof}

We have shown that there exists good codes from both the constructions, where, by a `good' code we mean a code with the design rate arbitrarily close to the capacity of AMGN channel and arbitrarily small probability of error under BP decoding. But for using Construction D and to be able to apply Forney's result we need to show existence of nested sequence of codes from the proposed constructions where each code in the sequence is a good code. We show this in the following theorems.

\begin{lemma}\label{Lemma:NestedGoodCodes1}
%Given $r,\sigma^{2}$, for any $\epsilon_{1},\epsilon_{2}>0$, there exists $d_{c},d_{v}^{1},\ldots, d_{v}^{r},L,w,$ and a
Given $r,\sigma^{2}$, for any $\epsilon>0$, there exists $d_{c},d_{v}^{1},\ldots, d_{v}^{r},L,w,$ and a nested sequence of codes $\mc{C}_{1}\subseteq \mc{C}_{2}\ldots \subseteq\mc{C}_{r}$ from the $(d_{c},d_{v}^{1},\ldots,d_{v}^{r},L,w)$ CU-SC-	LDPC ensemble such that 
\begin{align}
R(d_{v}^{i},d_{c},L,w)&>C_{\text{AMGN}}\left(\sigma_{i}\right)-5\epsilon, \text{ and} \label{Eqn:RateConditions1}\\
P_{b}^{BP}\left(\mc{C}_{i},\sigma_{i}\right)&<\epsilon \hspace{0.5cm}\text{ for }1\leq i \leq r\label{Eqn:Error Prob1},
\end{align}
where $\sigma_{i}^{2}=\frac{\sigma^{2}}{2^{2(i-1)}}$ is the effective noise variance of the AMGN channel observed 	at the $i^{\text{th}}$ stage of multi-stage decoding.
%and $P_{b}^{BP}\left(\mc{C}_{i},\sigma_{i}\right)$ denotes the average bit error probability under BP decoding for $\mc{C}_{i}$ over AMGN channel of noise variance $\sigma_{i}^{2}$.
\end{lemma}

\begin{IEEEproof}
For the given $\epsilon,\delta$ we choose $d_{c}$ large enough such that there exists parameters $d_{v}^{1},d_{v}^{2},\ldots,d_{v}^{r},L,w$ that satisfy \eqref{Eqn:RateConditions1} simultaneously for $i \in\{1:r\}$. For these parameters Lemma \ref{Lemma:BMSProof1} guarantees us the existence of codes $\mc{C}_{i}\in\mc{E}_{i}\coleq (d_{c},d_{v}^{i},L,w)$ CU-SC-LDPC ensemble such that \eqref{Eqn:Error Prob1} is satisifed for $i=\{1:r\}$.

%We will prove the result for the case $r=2$ i.e., the existence of a good nested pair of codes and for the cases $r>2$ the  proof extends naturally. In this proof we refer to a nested sequence of codes as `good' if each code in the sequence satisifes \eqref{Eqn:RateConditions1} and \eqref{Eqn:Error Prob1}.Given $r=2$, f
%we choose $(d_{c},d_{v}^{1},d_{v}^{2})$ such that 
%\begin{align*}
%1-\frac{d_{v}^{i}}{d_{c}}=C_{\text{AMGN}}(\sigma_{i})
%\end{align*}
%for $1\leq i \leq 2$.  

It was not only shown in \cite{kudekaruniversal} that any system that satisifies \eqref{Eqn:DE_SCLDPC} 
is capacity-achieving asymptotically in $L, w$ but also that almost all codes of sufficient length in the 
ennsemble are good over a BMS channel. More precisely, it (\cite{kudekaruniversal} Coroll	ary 43) states that for a given $\epsilon >0$, there exists $d_{v},d_{c}, L,w$ such that $R(d_{v},d_{c},L,w)\geq \text{C}_{\text{AMGN}}(\sigma^{2})-5\epsilon$ and
\begin{align}
\lim_{n\rightarrow\infty}\mbb{E}_{\mc{C}(n)\in(d_{v},d_{c},L,w)}\left[ \ind_{\{P_{b}^{BP}\left(\mc{C}(n),\sigma^{2}\right)\leq \epsilon\}}\right]=1,
\label{Corollary:AlmostGoodEnsemble}
\end{align}
where the average is over all codes $\mc{C}(n)$ of blocklength `$n$' from the $(d_{v},d_{c},L,w)$ SC-LDPC ensemble under uniform distribution. From Lemma \ref{Lemma:DE_SCLDPC}, $(d_{v},d_{c},L,w)$ CU-SC-LDPC ensemble satisfies \eqref{Eqn:DE_SCLDPC} and hence \eqref{Corollary:AlmostGoodEnsemble} is valid for $(d_{v}^{i},d_{c},L,w)$ the CU-SC-LDPC ensembles, $i\in\{1,2\}$. Hence we can choose $n$ large enough such that 
\begin{align}
\mbb{E}_{\mc{C}_{i}(n)\in \mc{E}_{i}}\left[	 \ind_{\{P_{b}^{BP}\left(\mc{C}_{i}(n),\sigma^{2}\right)\leq \epsilon\}}\right]\geq 1-\epsilon_{1},
\label{Eqn:Proof1.1}
\end{align}
for $i\in \{1,2\}$ where  the the average is over all codes of blocklength $n$ from $\mc{E}_{1}$.

 From Remark \ref{Rmk:EquivNestedConstr1}, this construction is equivalent to first drawing $\mc{C}_{2}$ from $\mc{E}_{2}$ under uniform distribution and then picking $\mc{C}_{i}$ from the set $\mc{E}_{1}(\mc{C}_{2})\coleq \{\mc{C}_{1}:\mc{C}_{1}\in \mc{E}_{1},\mc{C}_{1}\subseteq \mc{C}_{2}\}$ under uniform distribution. From the fact that the set $\mc{E}_{1}(\mc{C}_{2})$ has same cardinality for all choices of $\mc{C}_{2}$(see Remark \ref{Rmk:EquivNestedConstr1}), we can deduce that the marginal distribution on $\mc{C}_{1}$ is uniform on $\mc{E}_{1}$.\\
 For the sake of brevity we refer to code $\mc{C}_{i}\in\mc{E}_{i}$ as good if $P_{b}^{\text{BP}}(\mc{C}_{i},\sigma^{2}\leq \epsilon_{2})$ and bad if otherwise. 
 \begin{align*}
\tx{Pr}&\left[\mc{C}_{1}  \tx{ is bad  or } \mc{C}_{2} \tx{ is bad }\right] \\
%&=\tx{Pr}\left[\mc{C}_{2} \tx{ is bad} \right] +\tx{Pr}\left[\mc{C}_{1} \tx{ is bad}, \mc{C}_{2} \tx{ is good}\right] \\
&\leq \tx{Pr}\left[\mc{C}_{2} \tx{ is bad} \right] +\tx{Pr}\left[\mc{C}_{1} \tx{ is bad}\right] \\
&\leq 2\epsilon_{1}
 \end{align*}
 where the last inequality follows from the uniform marginal distribution on $\mc{C}_{1}$. This not only gives us the existence of a good pair of nested codes arbitrarily close to capacity but also that almost all nested pairs from $(d_{c},d_{v}^{1},d_{v}^{2})$ CU-SC-LDPC ensemble are good.
% We prove by contradiction i.e., assume that there does not exist a pair of good nested codes $\mc{C}_{1}\subseteq \mc{C}_{2}$ from the $(d_{c},d_{v}^{1},d_{v}^{2})$ CU-SC-LDPC ensemble. This gives us that, for every good code $\mc{C}_{2}\in (d_{c},d_{v}^{2})$ CU-SC-LDPC ensemble, all the possible choices for $\mc{C}_{1}$ are not good codes. To be precise, given that  $\mc{C}_{1}(n)\subseteq \mc{C}_{2}(n)$,
% \begin{align}
%\text{Pr}\left[P_{b}^{BP}\left(\mc{C}_{1}(n),\sigma^{2}\right)\geq \epsilon_{1} |  P_{b}^{BP}\left(\mc{C}_{2}(n),\sigma^{2}\right)\leq \epsilon_{1}\right]=1.
% \label{Eqn:Proof1.2}
% \end{align}
% But from \eqref{Eqn:Proof1.1},
% \begin{align}
% \text{Pr}\left[P_{b}^{BP}\left(\mc{C}_{2}(n),\sigma^{2}\right)\leq \epsilon_{1} \right] \geq 1-\epsilon_{1}.
% \label{Eqn:Proof1.3}
% \end{align} 
%But Remark \ref{Rmk:EquivNestedConstr1} tells us that for each $\mc{C}_{2}$ there are equal number of choices for $\mc{C}_{1}$, all of which are equally likely. Combining this with \eqref{Eqn:Proof1.2} and \eqref{Eqn:Proof1.3} gives us that
% \begin{align*}
%\text{Pr} \left[ P_{b}^{BP}\left(\mc{C}_{1}(n),\sigma^{2}\right)\geq \epsilon_{1}\right] \geq 1-\epsilon_{1}
% \end{align*}
% which contradicts $\eqref{Eqn:Proof1.1}$.
\end{IEEEproof}

\begin{lemma}\label{Lemma:NestedGoodCodes2}
Given $r,\sigma^{2}$, for any $\epsilon_{1},\epsilon_{2}>0$, there exists $d_{c},d_{v}^{1},\ldots, d_{v}^{r},L,w,$ and a nested sequence of codes $\mc{C}_{1}\subseteq \mc{C}_{2}\ldots \subseteq\mc{C}_{r}$ from the $(d_{c},d_{v}^{1},\ldots,d_{v}^{r},L,w)$ VC-SC-LDPC ensemble such that \eqref{Eqn:RateConditions1} and \eqref{Eqn:Error Prob1} are satisfied.
\end{lemma}

\begin{IEEEproof}
In the above proof, using Remark \ref{Rmk:Same_DE}, Lemma \ref{Lemma:BMSProof2} and Remark \ref{Rmk:EquivNestedConstr2}  instead of  Lemma \ref{Lemma:DE_SCLDPC}, Lemma \ref{Lemma:BMSProof1} and Remark \ref{Rmk:EquivNestedConstr1} gives us the required proof.

\end{IEEEproof}

\begin{theorem}\label{Thm:Poltyrev_good}
   For any $\epsilon,\delta>0$, there exists a CU-SC-LDPC lattice $\Lmb$ with $\alpha^2(\Lambda,\sigma^2)<1+\epsilon$ for which, under multistage BP decoding, the average probability of error $P(\Lmb,\sigma^{2})<\delta$.
\end{theorem}
\begin{IEEEproof}
We first choose $r$ large enough such that 
\begin{align*}
P_{b}\left(\Z_{2^{r}}^{n},\sigma_{r+1}\right)&<\epsilon_{2} ,
\end{align*}
where $P_{b}\left(\Z_{2^{r}}^{n},\sigma_{r+1}\right)$ is the average bit error probability in decoding a point chosen uniformly at random from $\Z_{2^{r}}^{n}$ under minimum distance(Euclidean) decoder. 
Then from Lemma \ref{Lemma:NestedGoodCodes1} there exists $(d_{c},d_{v}^{1},\ldots,d_{v}^{r})$ and $\mc{C}_{1}\subseteq \mc{C}_{2}\subseteq \ldots \subseteq \mc{C}_{r}$ from the $(d_{c},d_{v}^{1},\ldots,d_{v}^{r})$ the CU-SC-LDPC ensemble such that 
\begin{align}
R(d_{v}^{i},d_{c},L,w)&>C_{\text{AMGN}}\left(\sigma_{i}\right)-\epsilon_{1}, \text{ and} \\
P_{b}^{BP}\left(\mc{C}_{i},\sigma_{i}\right)&<\epsilon_{2} \hspace{0.5cm}\text{ for }1\leq i \leq r,
\end{align}
where $\sigma_{i}^{2}=\frac{\sigma^{2}}{2^{2(i-1)}}$ is the effective noise variance of the AMGN channel observed at the $i^{\text{th}}$ stage of multi-stage decoding. Then we choose $\epsilon_{2}=\frac{\delta}{r+1}$, use the union bound to bound the total block error probability $P_{b}(\Lmb,\sigma)$ and we then recall  Eqn \eqref{Eqn:VNRInequality} and Remark~\ref{Rmk:Forney_proof} to complete the proof.
\end{IEEEproof}

\begin{Remark}[Comparison with LDPC lattices]
    LDPC codes have been adopted as underlying codes for constructing lattices in \cite{sadeghi06} where the so-called LDPC lattices have been proposed and analyzed. Our SC-LDPC lattices differ from LDPC lattices in the following ways. Firstly, LDPC lattices are constructed based on Construction D$^{\prime}$ \cite{BarnesSloane83} in contrast to Construction D adopted here. Secondly, our decoding algorithm is a multistage BP decoding which only works over $\mbb{F}_2$, on the contrary, since constructed based on Construction D$^{\prime}$, LDPC lattices have to considered BP algorithm on the joint Tanner graph \cite{Banihashemi01} (i.e., joint decoding). Last but not least, since there are no analytical evidence that LDPC codes under BP decoding would achieve capacity, LDPC lattices have not been shown Poltyrev-good to the best of our knowledge while for the proposed SC-LDPC lattices, Theorem~\ref{Thm:Poltyrev_good} serves as constructive evidence.
\end{Remark}


\subsection{Design and Simulation Results}
In this subsection, we give a design example of SC-LDPC lattices that approach the Poltyrev limit. Before we explain the design of Poltyrev-good SC-LDPC lattices, we will analyze the average probability of decoding error.

As we use multistage decoding, the average probability of decoding error $p(\Lmb,\sigma^{2})$, can be union bounded by the sum of block error probabilities at individual levels. Assuming CU-SC-LDPC code at each level is operating below the BP threshold, the average probability of decoding error of the lattice is dominated by the performance of the last (uncoded) level. 
Let us denote the block error probability for the $(r+1)^{\text{th}}$ level by $P(\Z_{2^r}^{n},\sigma^{2})$. Under minimum distance decoding, $P(\Z_{2^r}^{n},\sigma^{2})$ is given by
\begin{align}
P(\Z_{2^r}^{n},\sigma^{2})&\overset{(a)}\leq nP(\Z_{2^r},\sigma^{2})=n\left(2Q\left(\frac{0.5}{\sigma_{r+1}}\right)	\right)
\label{ZLatticeProb}
\end{align}
where (a) is due to union bound and $\sigma_{r+1}\defeq \sigma/2^r$ is the effective noise observed at the last level.
\begin{figure}[h!]
\centering
\includegraphics[width=4in]{./figures/Cap_integer_coset_lattice.eps}
\caption{Channel capacity of the AMGN channel}
\label{AMGNCapacity}
\end{figure}

Let the number of levels required be $r+1$, with $r$ levels using nested SC-LDPC codes and the last level be the $\Z_{2^r}^{n}$ uncoded lattice. The effective noise seen by $i^{\text{th}}$ level is denoted as $\sigma_{i}\defeq\sigma/2^{i-1}$. For $n=2 \times 10^{5}$ and target block error probability of $10^{-4}$, \eqref{ZLatticeProb} gives us $\sigma_{r+1}= 0.0804$ and moving to the next level, $\sigma_{r}=2\sigma_{r+1}=0.1608$. For the details on capacity of AMGN channel we refer to \cite{forney2000}. The capacity for level $r$ is $C(\Z/2\Z,\sigma_{r})=0.9923$ and similarly proceeding, $\sigma_{r-1}=2\sigma_{r}=0.3217$, $C(\Z/2\Z,\sigma_{r-1})=0.5726$, $\sigma_{r-2}=2\sigma_{r-1}=0.6434$, $C(\Z/2\Z,\sigma_{r-2})=0.0242$.
Observe that the capacity for level $r-2$ is almost zero which renders coding for this level unnecessary although this results in a very small increase in VNR (due to rate the loss) of $0.145$dB $(=20\log_{10}2^{0.0242})$. We use $r=2$ (i.e., 3 levels) and ($30,14,3$) CU-SC-LDPC ensemble with $L=32, w=4$ is used for the first two levels and the uncoded $\Z_{4}^{n}$ lattice is used in the last level.

\begin{table}
\centering
\caption{DE thresholds and Gap from Poltyrev limits (without rate loss from termination) for SC-LDPC lattice ensembles for various degree profiles.}
\begin{tabular}{c c c c c c}
\hline  \hline
$(d_{c},d_{v}^{1},d_{v}^{2})$ &(L,w)& $\sigma_{\text{max}}$ &$\text{VNR}^{*}$ &$\text{VNR}_{\text{rate-loss}}$\\
\hline
(30,14,3) & (32,4) & 0.3184 & 1.14dB & 1.347dB\\
(60, 27, 3)& (64, 9)  &  0.3203 & 0.57dB & 0.951\\
(60, 26, 3)& (72, 12) & 0.3200 &0.482dB & 0.927dB\\
(60, 42, 3)& (72, 12) & 0.3975 & 0.203dB &---\\
%(30,14,3) & (32,4) & 0.3184 &0.2184 &1.14dB&1.347dB\\
%(60, 27, 3)& (64, 9)  &  0.3203 & 0.1953 &0.57dB&0.951\\
%(60, 26, 3)& (72, 12) & 0.3200 & 0.1953 &0.482dB&0.927dB\\
%(60, 42, 3)& (72, 12) & 0.3975 & 0.1953 &0.203dB&---
%(60,42,3)&(72,12)&0.3975&0.1953&0.203dB\footnote{Target Bit Error Probability of $10^{-6}$}&---
\end{tabular}
\label{Table:Thresholds}
\end{table}

Due to symmetry in the lattice the all-zero lattice point is assumed to be transmitted. Instead of plotting the symbol error rate, we focus on determining the thresholds of the resulting lattice under BP decoding. We estimate the BP threshold by determining the maximum noise variance for which no codeword errors are observed in simulation of 10 consecutive codewords each of length $2\times 10^{5}$. We calculate the maximum variance for which both levels of the lattice can be decoded, $\sigma_{\text{max}}=\min(\sigma_{1}^{\text{BP}},2\sigma_{2}^{\text{BP}})$, where $\sigma_{1}^{\text{BP}}$ and $\sigma_{2}^{\text{BP}}$ are the respective BP thresholds for the two SC-LDPC codes. The VNR threshold is then calculated for the given rates and $\sigma_{\text{max}}$. Thus obtained BP thresholds $\sigma_{1}^{\text{BP}}$, $\sigma_{2}^{\text{BP}}$ for the above codes are $0.3142$ and $0.2161$ respectively which results in a VNR of $1.14$dB ($1.46$dB with rate loss due to termination). The DE predicted values are $0.3184$ and $0.21836$. We observe that the BP thresholds are very close to DE thresholds. i.e., the parameters are large enough to assume that the BP thresholds can be approximated by DE thresholds. Therefore it is reasonable to calculate the VNR thresholds using the DE thresholds. For various SC-LDPC ensembles Table. \ref{Table:Thresholds} gives the respective DE and VNR thresholds. Note that the Poltyrev limit is zero dB, thus making the VNR threshold and the gap from Poltyrev limit equivalent. The gap to the Poltyrev limit is primarily due to the fact that there is a mismatch between the rates that are obtainable for the proposed ensemble with a fixed $d_c$ and the capacity of the equivalent channel.
%
%very high capacity ($\approx 1$) in the last level and a very low capacity ($\approx 0$) in the first level and there is a mismatch in the rate of the LDPC code and the corresponding capacity. Even though SC-LDPC codes of such extreme rates (requires complex degree profiles) can be implemented thus achieving the Poltyrev limit, BP decoding for such high degrees becomes computationally complex.

In the above design, if we target a bit error probability of $10^{-6}$ instead, that gives us $\sigma_{r+1}= 0.0999$, capacities for the subsequent levels $C(\Z/2\Z,\sigma_{r})=0.9507$, $C(\Z/2\Z,\sigma_{r-1})=0.3223$ and $C(\Z/2\Z,\sigma_{r-2})=0.0024$. Pair of nested codes from $(60,42,3)$ CU-SC-LDPC ensemble gives us rates $0.3$ and $0.95$ resulting in better matching of the rates (negligible rate loss). The resulting DE thresholds are within $0.203$dB from Poltyrev limit. This is reported in the last row in the table.

\section{Application - Interference Channels}
\subsection{Problem Statement}
We consider the 3 user Gaussian IC consisting of 3 transmitters, 3 receivers, and 3 independent messages originally considered in \cite{sridharan2008capacity}, where message $W_{j}$ originates at transmitter $j$ and is intended for receiver $j$, $\forall j\in \mc{J}\defeq\{1,2,3\}$. The output observed at the receiver $j$ is given by
\begin{align}\label{SymmInterfChannel}
    \mathbf{y}_{j}=\mathbf{x}_{j}+ \sum^{3}_{k=1,k\neq j}h_{jk}\mathbf{x}_{k}+\mathbf{z}_{j}, \hspace{10pt} \forall j\in \mc{J}
\end{align}
where $\mathbf{x}_{j}$ is the transmitted signal at $j^{\text{th}}$ transmitter, $h_{jk}$ are the channel parameters for the cross links, and $\mathbf{z}_{j}\sim\mc{N}(\mathbf{0},\sigma^{2}\cdot \mathbf{I})$ is the AWGN noise. If the channel parameters for all the cross links are equal we refer to such model as symmetric IC. The channel input signals are subjected to the power constraint
$\frac{1}{n}\sum_{i=1}^{n}E\left[\|\mathbf{x}_{j}\|^2\right]\leq P$.

For a $2$-user symmetric Gaussian interference channel (IC) it was shown in \cite{carleial1978interference} that, in the very strong interference regime, the capacity region for the IC is as if there is no interference at all. For this symmetric model, a simple extension of the very strong interference condition for the 2 user IC %\cite{carleial1978interference}
to the 3 user one is given by \cite{sridharan2008capacity}
\begin{align}
\beta^{2}\geq \frac{\left((1+P)^{2}-1\right)\left(1+P\right)}{2P}.
\label{Eqn:StrongInterfCondition1}
\end{align}

Sridharan \textit{et al.} in \cite{sridharan2008capacity} introduce the idea of lattice alignment where each user uses a lattice code and each receiver first decodes the total interference (aligned due to lattice structure) observed and then decodes the desired message. For this case, they
derived a tighter condition on $\beta$ in order for the interference to be decoded first. This is based on lattice coding, independent of the number of users, and is given by
\begin{align}
\beta^{2}(\sigma)\geq \beta^{*^{2}}(\sigma)\defeq\frac{(P+\sigma^{2})^{2}}{P\sigma^{2}}
\label{Eqn:StrongInterfCondition2}
\end{align}
If \eqref{Eqn:StrongInterfCondition2} is satisfied, each user can achieve a capacity \cite{sridharan2008capacity} of
$\frac{1}{2}\log(1+\frac{P}{\sigma^{2}})$. Equivalently, for a given rate $R$, maximum noise variance under which the rate can be achieved is given by
\begin{align}
\sigma^{2}_{\text{max}}=\frac{P}{2^{2R}-1}.
\label{Eqn:SigmaShannon}
\end{align}

\subsection{Applying the Proposed Lattices}
Encouraged by the Poltyrev-limit achieving property of the proposed lattice ensembles under BP decoding, we use SC-LDPC lattice codes for the symmetric Gaussian IC in the very strong interference region. Let $\Lmb_{SC}$ be the SC-LDPC lattice defined in \eqref{Eqn:ConstrD} with $r=2$.
% and a code from $(30,15,5)$ CU-SC-LDPC ensemble is used for the two levels.
We define the SC-LDPC lattice code $\mc{C}_{SCL}$ based on $\Lmb_{SC}$ using hypercube shaping:
\begin{align}
\mc{C}_{SCL}=\left\lbrace \mathbf{\lambda} \mod \Z_{4}^{n}: \mathbf{\lambda} \in \Lmb \right\rbrace
\end{align}
where $n$ is the dimension of $\Lmb_{SC}$. Let codeword $\mathbf{c}_{j}\in\mc{C}_{SCL}$ at transmitter $j$ be
\begin{align}
\mathbf{c}_{j}&= \sum_{i=1}^{k_{1}}\alpha_{ji}\mathbf{g}_i+2\sum_{i=1}^{k_{2}}\beta_{ji}\mathbf{g}_i \mod \Z_{4}^{n}\hspace{15pt} \alpha_{ji},\beta_{ji}\in \{0,1\}\\
\label{Eqn:SICCodeword}
&= \sum_{i=1}^{k_{1}}\alpha_{ji}\mathbf{g}_i+2\sum_{i=1}^{k_{2}}\beta_{ji}\mathbf{g}_i -4\mathbf{k}_{j}, \ \mbox{for some} \ \mathbf{k}_{j}\in\Z^{n}
\end{align}
where "$+$" denotes addition in $\R^{n}$. Each codeword $\mathbf{c}_{j}\in\mc{C}_{SCL}\subset\{0,1,2,3\}^{n}$ is modulated to $\mathbf{\tilde{x}}_{j}\defeq 1.5^{n}-\mathbf{c}_{j}$ such that $\mathbf{\tilde{x}}_{j}\in\mc{A}\defeq\{-1.5,-0.5,+0.5,+1.5\}^{n}$. At transmitter $j$, a dither vector $\mathbf{d}_{j}$ uniformly distributed among $\mc{B}\defeq [-2,2)$ is added to obtain the transmitted signal $\mathbf{x}_j$ given by
\begin{align}
\mathbf{x}_{j}=\mathbf{\tilde{x}}_{j}+\mathbf{d}_{j} \mod \Z_{4}^{n},
\label{Eqn:SICdither}
\end{align}
where the mod operation is over $\mc{B}$ instead of $[0,4)$. The dither vector achieves the purpose of randomizing the interference and helps in treating the undesired components of the received signal as additive uncorrelated noise. From $\eqref{Eqn:SICModulation}$ it can be seen that $\mathbf{x}_{j}$ is uniformly distributed over $\mc{B}$ and the average power of the transmitted signal at each transmitter is $1.33$.

\begin{figure*}[t]
\centering
\resizebox{0.8\textwidth}{!}{
\input{./figures/SIC_decoder.tex}
}
\caption{System flow for the 3-user Symmetric Gaussian Interference channel at receiver 1.}
\label{Fig:SIC_decoder}
\end{figure*}

\subsection{Decoding}
Before looking at the general case let us consider the symmetric Gaussian IC i.e $h_{12}=h_{13}$. Without loss of generality let us consider receiver 1. The system flow from the perspective of receiver 1 is given in Fig.~\ref{Fig:SIC_decoder}. The input to the multistage decoder at receiver 1 is given by
\begin{align*}
\tilde{\mathbf{y}}_{1} &\defeq \frac{\mathbf{y}_{1}}{h_{12}}-\mathbf{d}_{2}-\mathbf{d}_{3}+1.5^{n}+1.5^{n}\\%\mod \Z_{4}^{n} \\
&=\mathbf{c}_{2}+\mathbf{c}_{3}+\frac{1}{h_{12}}\left(\mathbf{x}_{1}+\mathbf{z}_{1}\right).
\end{align*}
The key here is that $\mathbf{c}_{2},\mathbf{c}_{3}\in\mc{C}_{SCL}\subset\Lmb$ and hence $\mathbf{c}_{2}+\mathbf{c}_{3}\in \Lmb$.
\begin{align*}
\mathbf{c}_{2}+\mathbf{c}_{3}&=\sum_{i=1}^{k_{1}}\left(\alpha_{2i}+\alpha_{3i}\right)\mathbf{g}_i+2\sum_{i=1}^{k_{2}}\left(\beta_{2i}+\beta_{3i}\right)\mathbf{g}_i +4\mathbf{k}_{2}+4\mathbf{k}_{3}\\
&=\sum_{i=1}^{k_{1}}\left(\alpha_{2i}\oplus\alpha_{3i}\right)\mathbf{g}_i+2\sum_{i=1}^{k_{2}}\left(c_{1i}\oplus\beta_{2i}\oplus\beta_{3i}\right)\mathbf{g}_i +4\mathbf{k}_{23}
\end{align*}
where $c_{1i}=0.5\left(\alpha_{2i}+\alpha_{3i}-\alpha_{2i}\oplus\alpha_{3i}\right)$, $c_{2i}=0.5\left(c_{1i}+\beta_{2i}+\beta_{3i}-c_{1i}\oplus\beta_{2i}\oplus\beta_{3i}\right)$ are carryovers from first and second levels respectively and
 $\mathbf{k}_{23}=\mathbf{k}_{2}+\mathbf{k}_{3}+\sum_{1}^{k_{2}}c_{2i}\mathbf{g}_{i}\in\Z^{n}$. The key point is that $c_{1i}, c_{2i} \in \{0,1\}$. Using multi-stage decoder described in Section \ref{Sec:SCLDPC}, one can directly decode the lattice point $\mathbf{x}_{2}+\mathbf{x}_{3}$(interference), subtract it and decode the desired signal.

The decoding scheme above extends to the case when one channel gain is an integer multiple of the other. For example, let $h_{13}=Kh_{12}$
where $K=\sum_{0}^{l-1}a_{i}2^{i}\in \Z, a_{i}\in\{0,1\}$. In this case, input to the multi-stage decoder is
%where $K=\sum_{0}^{l-1}a_{i}2^{i}\in \Z$, $a_{i}\in\{0,1\}$. In this case input to the multi-stage decoder is
\begin{align*}
\tilde{\mathbf{y}}_{1} &\defeq \frac{\mathbf{y}_{1}}{h_{12}}-\mathbf{d}_{2}-K\mathbf{d}_{3}+1.5^{n}+K1.5^{n}\\
&=\mathbf{c}_{2}+K\mathbf{c}_{3}+\frac{1}{h_{12}}\left(\mathbf{x}_{1}+\mathbf{z}_{1}\right).
\end{align*}
where $\mathbf{c}_{2}+K\mathbf{c}_{3}$ is a lattice point and is given by
\begin{align*}
%\mathbf{c}_{2}+K\mathbf{c}_{3}=
\sum_{i=1}^{k_{1}}\left(\alpha_{2i}\oplus a_{0}\alpha_{3i}\right)\mathbf{g}_i+2\sum_{i=1}^{k_{2}}\left(c_{1i}\oplus\beta_{2i}\oplus a_{0}\beta_{3i}\oplus a_{1}\alpha_{3}\right)\mathbf{g}_i+4\mathbf{k}
\end{align*}
for some $\mathbf{k}\in\Z^{n}$.


\subsection{Simulation Results for Symmetric IC}
In this section we present simulation results for the symmetric Gaussian IC and compare them with the bounds given in \cite{sridharan2008capacity}. We choose a pair of nested codes from the $(30,18,3)$ CU-SC-LDPC ensemble with spatial-coupling parameters $(L,w)=(32,4)$. We fix $\sigma=\sigma_{\text{max}}$ (such that in absence of interference, desired signal can be decoded successfully) and we analyze the bit error probability in decoding the interference versus the channel gain $\beta$. We observe that within $0.396$dB of the very strong interference regime given by \eqref{Eqn:StrongInterfCondition2} we are able to decode the interference with a bit error probability of less than $10^{-6}$. Note that the main bottle neck in error performance in decoding the interference is the last i.e., the uncoded level whereas in decoding the desired signal (after the interference is decoded and subtracted), within $\sigma_{\text{max}}$, arbitrarily small error rates can be achieved since no uncoded level needs to be decoded.

%On a single user AWGN channel i.e, after the interference is subtracted, the DE threshold for this code for the given parameters is computed to be $\sigma_{\text{max}}=0.3351$ whereas asymptotically the maximum achievable variance is $\sigma_{\text{AMGN}}=0.3728$. The Shannon capacity from \eqref{Eqn:SigmaShannon} is given by $\sigma_{\text{Sh}}=0.4969$ which is equivalent to a gap of $2.5$dB.

In Fig.~\ref{Fig:ShapingLoss}, we plot the achievable rate as a function of $P/\sigma^2$ for the desired user for $r=4$. It can be seen that the achievable rate with the lattice code has a gap of roughly 1.53~dB from the corresponding Shannon limit at high rates. This is the shaping loss due to hypercube shaping.  The DE thresholds with the proposed SC-LDPC codes is also shown in the plot and it can be seen that the DE thresholds are very close to the achievable rates.
%
%We also observe that as the number of levels increase this gap converges to $1.53$dB which corresponds to the loss due to the sub-optimal hypercube shaping. For a 4-level binary lattice code with hypercube shaping corresponding gap between shannon capacity and the sum-capacity of 4 levels is plotted  in Fig. \ref{Fig:ShapingLoss}. One can also observe that the sum-capacity can be very closely achieved with a SC-LDPC lattice code of maximum check node degree 60.
%Thus we claim that with optimal shaping strategies the capacity of the $K$-user symmetric Gaussian IC \cite{sridharan2008capacity} in the very strong interference channel can be achieved.

\begin{figure}
\centering
\setlength\figureheight{0.6\columnwidth}
\setlength\figurewidth{0.8\columnwidth}
\input{./figures/ShapingLoss_Final}
\caption{Gap between the Shannon capacity and the sum-capacity of a 4-level Construction D lattice code(hypercube shaping) under multi-stage decoding. The DE thresholds for various SC-LDPC lattice codes with a maximum check node degree of $60$ are also given.}	
\label{Fig:ShapingLoss}	
\end{figure}

\section{Application - Bi-Directional Relay Channel}
\subsection{Problem Statement}
We consider the Bi-Directional Relay channel where two users try to communicate with each other with the help of a relay node acting as an intermediate. Objective is to design coding schemes at both the users and forwarding scheme at the relay such that at each user the message intended to be transmitted by the other user can be decoded, given the availability of the noise corrupted forwarded signal from the relay.
The problem can be very simply described by these three equations: 
\begin{align*}
y_{R}=a x_{1}+b x_{2}+z \\
y_{1}=x_{F}+z_{1} \\
y_{2}=x_{F}+z_{2} 
\end{align*}
 are received signals at Relay, and Users 1 and 2 respectively and $x_{F}$ is the signal forwarded by the relay and is a function of the  forwarding scheme we use. For simplicity let's assume that $a,b\in \Z$.

\subsection{Proposed Scheme}
We define a code (finite constellation) from the Poltyrev-good SC-LDPC lattice as follows:
\begin{equation}
\mc{C}\defeq \Lmb_{C}\cap \Z_{5}^{N}
\end{equation}
Rate of hence defined code will be $\log_{2}(2^{r_{1}+r_{2}}\frac{5}{4})=r_{1}+r_{2}+\log_{2}(\frac{5}{4})$ bits/dim. User $i$ picks a codeword $x_{i}\in\mc{C}$ uniformly and transmits. The received signal at relay is:
\begin{align*}
y_{R}=a x_{1}+b x_{2} +z
\end{align*}
The additive group structure of the lattice and the fact that $x_{1},x_{2}\in \Lmb_{C}$ gives us $a x_{1}+b x_{2}\in \Lambda_{C}$. Using the multi-stage decoding described previously we decode the lattice point $a x_{1} + b x_{2}\in \Lmb_{C}$. Note that in the decoder we need to do the euclidean decoder in the last stage too since not just the corresponding coset of $a x_{1}+b x_{2}$ suffices but we need the actual lattice point.

%For the forwarding part, we compute 
%\begin{align}
%x_{F}=a x_{1} +b x_{2} \mod 5\Z^{N}.
%\end{align}
%Note that since $5\Z^{N}\not \subset \Lmb_{C}$, $x_{F}\in \Lmb_{C}$ is not necessarily true. But for our application this won't be  a problem and we will see why subsequently.
%
%Let's consider User 1 and see how we can decode $x_{2}$ given $y_{1}=x_{F}+z_{1}$ .
% \begin{align*}
% y_{1}&=\left(a x_{1} +b x_{2} \right) \mod 5 +z_{1}\\
% &=\left[ a x_{1} \mod 5 +b x_{2} \mod 5 \right] \mod 5+z_{1}\\
% \end{align*}
%
%  \begin{align*}
%\left[ y_{1}-ax_{1}\right]\mod 5&=\left(\left(a x_{1} +b x_{2} \right) \mod 5 +z_{1}-ax_{1}\right)\mod 5\\
% &=\left[ a x_{1} \mod 5 +b x_{2} \mod 5 +z_{1} \mod 5 -a x_{1}\mod 5\right] \mod 5\\
%  &=\left[b x_{2} \mod 5 +z_{1} \mod 5 \right] \mod 5\\
% \end{align*}
% Assuming $b\not \equiv 0 \mod 5$, $\exists b^{-1}\in \Z_{5}$ such that $b^{-1}b\equiv 1\mod 5$.
%  \begin{align*}
%b^{-1}\left[ y_{1}-ax_{1}\right]\mod 5&=b^{-1}\left[b x_{2} \mod 5 +z_{1} \mod 5 \right] \mod 5\\
%&=\left[ x_{2} \mod 5 +b^{-1}z_{1} \mod 5 \right] \mod 5\\
%&=\left[ x_{2} +b^{-1}z_{1} \mod 5 \right] \mod 5\\
% \end{align*}
% The last step is because $x_{2}\mod 5=x_{2}\in \Lmb_{C}$ and hence we can decode $x_{2}\in \mc{C}$.
% \subsection{Performance : Analysis}
% This scheme, will be at a gap of atleast 1.53 dB from the AWGN channel capacity(for a given noise variance $\sigma^{2}$ for the uplink channel). If we can reduce this gap by using some vector quantzation scheme instead of the scalar quantization scheme( hypercube shaping) and at the same time avoid the zero divisor problem, that would be great.\\
% 
% Let $\Lmb_{S}$ be the shaping lattice generated using a convolutional code over $Z_{5}^{N}$ and then tessellating it over the entire space using $+5\Z^{N}$. \\
% Claim 1:We can guarantee that for all $x_{i},x_{j}\in \mc{C}$ and $x_{i}\neq x_{j}$, $x_{i} \mod \Lmb_{S}\neq x_{j}\mod \Lmb_{S}$. \\
% Claim 2: And also because of the tessellation, $x_{i} \mod \Lmb_{S}= x_{i}+5\mbf{k}\mod \Lmb_{S}$ for any $\mbf{k}\in \Z^{N}$.\\
%   With these two claims, if $x_{i}=\lambda_{i}\mod \Lmb_{S}$ for $i=1,2$,
%   \begin{align*}
%   y_{R}&=a(\lambda_{1}\mod \Lmb_{S})+b(\lambda_{2}\mod \Lmb_{S})+z\\
%   y_{R}\mod \Lmb_{S}&=(a\lambda_{1}+b\lambda_{2})\mod \Lmb_{S}+z\mod \Lmb_{S}\\
% 									&=\left[(a\lambda_{1}+b\lambda_{2})\mod 5\right]\mod \Lmb_{S}+z\mod \Lmb_{S}\\
%   \end{align*}
%   and there is no guarantee that $(a\lambda_{1}+b\lambda_{2})\mod 5\in \Lmb_{C}\cap \Z_{5}^{N}$ and hence in decoding $a x_{1}+bx_{2}\mod \Lmb_{S}$ we loose the error performance protection afforded by the SC LDPC codes in the Coded Lattice $\Lmb_{C}.$
%   
%   Hence as of now, the shaping loss of 1.53dB looks unavoidable if we want to avoid the zero divisor problem.
\bibliographystyle{ieeetr}
\bibliography{journal_abbr,bib_SCLDPC}

\end{document}